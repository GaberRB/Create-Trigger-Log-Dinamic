# Create-Trigger-Log-Dinamic

Cria uma trigger de log de forma dinâmica, apenas informando o nome da tabela será criado a tabela de registros e a trigger em um diretório especifico do banco de dados oracle.

APÓS EXECUÇÃO
VERIFICAR O OUTPUT DO CAMINHO DA GERAÇÃO DOS ARQUIVOS.

PROCEDIMENTO PARA CRIAR TRIGGER DE LOG DE UMA RESPECTIVA TABELA,
SERÁ CRIADO COM BASE EM TODAS AS COLUNAS E SERÁ GRAVADO QUALQUER
ALTERAÇÃO DE UPDATE, OS REGISTROS SERÃO INSERIDOS NA TABELA_LOG,
AO EXECUTAR O PROCEDIMENTO SERÁ GERADO 2 ARQUIVOS TXT, PARA CRIAÇÃO
DA TABELA E DA TRIGGER;

OS LOGS SERÃO DEMOSTRADOS DA SEGUINTE FORMA 
TABELA : NOME DA TABELA DE LOG
CHAVE : PRIMARY KEY DA TABELA
DATA : DATA DE ALTERAÇÃO
CONTEÚDO: Coluna VLRDESCCOMERCIAL alterado DE 1 PARA: 0
VSUSERBANCO: USUARIO DO BANCO 
VSTERMINAL: IP DA MAQUINA
VSMODULO:  APLICAÇÃO 
VSACTION: AÇÃO REALIZADA VIA BANCO   
VSUSERAPP: USUARIO DA APLICAÇÃO
VSUSERMAQ: USUARIO DO SISTEMA OPERACIONAL  
*/
DECLARE
DIRUTL VARCHAR2(4000);
NOMETABELA VARCHAR2(4000) := ''; --NOME DA TABELA PARA CRIAR LOG
VOUT VARCHAR2(4000);
BEGIN
  SELECT DIRECTORY_PATH
  INTO DIRUTL
  FROM ALL_DIRECTORIES
  WHERE DIRECTORY_NAME = 'ARQUIVOS'; 
  CRIA_TRIGGER_LOG(PTABELA => NOMETABELA, PDIRETORIO => DIRUTL);
  
  SELECT 'DIRETORIO: '||'\\'||UTL_INADDR.GET_HOST_ADDRESS(HOST_NAME)||'\ARQUIVOS'||CHR(13)||'BANCO: ' || HOST_NAME 
  INTO VOUT
  FROM V$INSTANCE;
  DBMS_OUTPUT.put_line(VOUT);
END;
